<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>The Chess Arena Pi</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
  :root {
    --bg:#1f2937;
    --card:#1f2f4f;
    --text:#e2e8f0;
    --light-square:#f0fff4;
    --dark-square:#c8facc;
    --khaki:#b7a97a;
    --black-piece:#1f1f1f;
    --radius:14px;
    --shadow:0 30px 70px -10px rgba(0,0,0,0.45);
  }
  [data-theme="light"] {
    --bg:#f0f5fa;
    --card:#ffffff;
    --text:#1f2d3d;
  }
  *{box-sizing:border-box;}
  body {
    margin:0;
    background:linear-gradient(135deg,#0f172a 0%,#1f2937 80%);
    font-family: system-ui,-apple-system,BlinkMacSystemFont,sans-serif;
    color: var(--text);
    min-height:100vh;
    padding:1rem;
    display:flex;
    flex-direction:column;
    align-items:center;
    transition:background .3s,color .3s;
  }
  .app { width:100%; max-width:1100px; display:grid; gap:1rem; }
  .top { display:flex; flex-wrap:wrap; justify-content:space-between; align-items:center; gap:10px; margin-bottom:6px; }
  .logo { display:flex; align-items:center; gap:8px; font-weight:700; font-size:1.3rem; }
  .logo img { width:42px; height:42px; border-radius:10px; background:rgba(255,255,255,0.08); padding:6px; }
  .controls { display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
  .btn { background:#10b981; border:none; padding:10px 14px; border-radius:999px; cursor:pointer; font-weight:600; display:inline-flex; align-items:center; gap:6px; transition:filter .2s; }
  .btn:hover { filter:brightness(1.1); }
  .small-btn { background:rgba(255,255,255,0.08); border:none; padding:8px 12px; border-radius:999px; cursor:pointer; font-size:0.8rem; display:inline-flex; align-items:center; gap:4px; }
  .theme-toggle { background:rgba(255,255,255,0.08); border:none; padding:8px 12px; border-radius:999px; cursor:pointer; font-size:0.9rem; }
  .card { background: var(--card); border-radius:16px; padding:18px; display:grid; gap:12px; box-shadow: var(--shadow); position:relative; }
  .status-bar { display:flex; flex-wrap:wrap; gap:12px; align-items:center; font-size:0.9rem; }
  .board { width:100%; max-width:560px; aspect-ratio:1; display:grid; border:4px solid rgba(255,255,255,0.08); border-radius:14px; overflow:hidden; user-select:none; position:relative; background:#1f2f4f; }
  .square { position:relative; display:flex; align-items:center; justify-content:center; font-size:1.4rem; cursor:pointer; transition:background .2s; }
  .light { background: var(--light-square); }
  .dark { background: var(--dark-square); }
  .piece { width:65%; height:65%; border-radius:8px; display:flex; align-items:center; justify-content:center; font-weight:700; user-select:none; pointer-events:none; font-size:1rem; }
  .piece.khaki { background: var(--khaki); color:#1f2d3d; }
  .piece.black { background: var(--black-piece); color:#fff; }
  .highlight { outline:3px solid rgba(255,255,255,0.8); }
  .timer-box { display:inline-flex; gap:6px; align-items:center; font-weight:700; padding:6px 10px; border-radius:999px; background:rgba(255,255,255,0.08); }
  .move-history { overflow-x:auto; font-size:0.75rem; padding:6px 10px; border-radius:10px; background:rgba(255,255,255,0.05); white-space:nowrap; flex:1; }
  .winner { font-weight:700; font-size:1.05rem; }
  .placeholder { background:rgba(255,255,255,0.04); border:2px dashed rgba(255,255,255,0.2); padding:12px; border-radius:12px; font-size:0.8rem; }
  .login-overlay {
    position:fixed;
    inset:0;
    background:rgba(15,23,42,0.96);
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    gap:20px;
    padding:24px;
    text-align:center;
    z-index:99;
    color:#fff;
    border-radius:0;
  }
  .login-box {
    background:rgba(255,255,255,0.06);
    padding:20px 26px;
    border-radius:16px;
    display:flex;
    flex-direction:column;
    gap:14px;
    min-width:260px;
    align-items:center;
  }
  .login-btn {
    background:#2563eb;
    border:none;
    padding:12px 18px;
    border-radius:999px;
    cursor:pointer;
    font-weight:600;
    display:inline-flex;
    align-items:center;
    gap:8px;
    font-size:1rem;
    color:#fff;
    transition:filter .2s;
  }
  .login-btn:hover { filter:brightness(1.1); }
  #confetti-canvas { position:fixed; inset:0; pointer-events:none; z-index:200; }
</style>
</head>
<body data-theme="dark">
  <canvas id="confetti-canvas"></canvas>

  <!-- Pi Login / logo placeholder -->
  <div class="login-overlay" id="login-overlay">
    <div class="login-box">
      <div style="display:flex; align-items:center; gap:10px;">
        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA4MDAgODAwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogIDxjaXJjbGUgY3g9IjQwMCIgY3k9IjQwMCIgcj0iMzgwIiBmaWxsPSIjMTBiOTgxIi8+CiAgPHRleHQgeD0iNDAwIiB5PSI0NTAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjIwMCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0iI2ZmZiI+PC90ZXh0Pgo8L3N2Zz4=" alt="logo" style="width:48px;height:48px;border-radius:10px; background:rgba(255,255,255,0.08); padding:6px;">
        <div style="font-size:1.5rem; font-weight:700;">Chess Arena Pi</div>
      </div>
      <div style="font-size:0.95rem; opacity:0.9;">Login with your Pi Network account to continue.</div>
      <button class="login-btn" id="pi-login-btn">Login with Pi</button>
    </div>
  </div>

  <div class="app">
    <div class="top">
      <div class="logo">
        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA4MDAgODAwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogIDxjaXJjbGUgY3g9IjQwMCIgY3k9IjQwMCIgcj0iMzgwIiBmaWxsPSIjMTBiOTgxIi8+CiAgPHRleHQgeD0iNDAwIiB5PSI0NTAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjIwMCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0iI2ZmZiI+PC90ZXh0Pgo8L3N2Zz4=" alt="logo" />
        <div>Chess Arena Pi</div>
      </div>
      <div class="controls">
        <div class="timer-box" aria-label="turn timer">
          <div>Time</div><div><span id="timer-display">30</span>s</div>
        </div>
        <div id="turn-indicator" style="font-weight:600;">You: Khaki</div>
        <button
