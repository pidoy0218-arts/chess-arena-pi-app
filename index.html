<!-- INTRO / LOGIN FRAME -->
<section id="frame-intro" class="frame active" aria-label="Intro">
  <div style="text-align:center;margin-bottom:12px">
    <div style="width:160px;height:160px;margin:0 auto;border-radius:40px;background:#110b09;display:grid;place-items:center;box-shadow:0 20px 60px rgba(0,0,0,.6)">
      <!-- stylized knight mark -->
      <svg width="96" height="96" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden>
        <defs><linearGradient id="g" x1="0" x2="1"><stop offset="0" stop-color="#f6d6a6"/><stop offset="1" stop-color="#c07a2e"/></linearGradient></defs>
        <circle cx="32" cy="32" r="30" fill="#2b1b12"/>
        <path d="M20 46c8-8 22-8 28 0" stroke="#f4b400" stroke-width="2" stroke-linecap="round"/>
        <path d="M18 28c6-6 22-10 30-4" stroke="#f4b400" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </div>
  </div>

  <div style="text-align:center">
    <button id="loginBtn" class="btn" style="background:#1abc9c;color:#111;font-size:18px;padding:14px 22px;">
      ðŸ”‘ Login with Pi (Test)
    </button>
    <div style="margin-top:12px;color:var(--muted)">Login with Pi lets you invite pioneers in sandbox & unlock multiplayer.</div>
  </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const loginBtn = document.getElementById('loginBtn');

  // Pi bridge simulation for Chrome
  if (!window.Pi) {
    window.Pi = {
      authenticate: async () => {
        return new Promise((res) => {
          setTimeout(() => res({ user: { username: "pioneer_guest" }, accessToken: "mock-token" }), 200);
        });
      },
      invite: async () => {
        return new Promise((res) => {
          alert("Simulated Pi Invite: friend selected (mock). Returning to game selector.");
          res({ invited: true, friendId: "pioneer_friend_01" });
        });
      }
    };
  }

  loginBtn.onclick = async () => {
    try {
      const res = await Pi.authenticate(['username','payments']);
      console.log("Login result:", res);
      alert("Logged in as: " + res.user.username);
      // switch frame to mode select
      document.getElementById('frame-intro').classList.remove('active');
      document.getElementById('frame-mode').classList.add('active');
    } catch (e) {
      console.error("Login failed:", e);
      alert("Login failed");
    }
  };
});
</script>
