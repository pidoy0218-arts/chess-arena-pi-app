<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Chess Arena Pi - Standalone</title>
  <style>
    :root{
      --bg: #111010;
      --board-light:#F0D9B5;
      --board-dark:#B58863;
      --piece-light:#F2F2E6;
      --piece-dark:#2B2B2B;
      --accent:#2F9F9A;
      --panel:#1a1a1a;
      --text:#fff;
    }
    html, body { height:100%; margin:0; font-family: Inter, Arial, sans-serif; background:var(--bg); color:var(--text); }
    .container { max-width: 1100px; margin: 0 auto; padding: 12px; }
    .header { display:flex; align-items:center; justify-content:space-between; padding:8px 12px; background: rgba(0,0,0,.25); border-radius:8px; margin-bottom:12px; }
    .brand { display:flex; align-items:center; gap:12px; }
    .brand img{ height:40px; }
    .btn { background: var(--accent); border:none; color:#fff; padding:10px 14px; border-radius:8px; font-weight:600; cursor:pointer; }
    .grid { display:grid; grid-template-columns: 1fr 360px; gap:14px; }
    @media (max-width: 900px) { .grid { grid-template-columns: 1fr; } }
    .board { width: min(92vmin, 640px); aspect-ratio:1; display:grid; grid-template-columns:repeat(8,1fr); grid-template-rows:repeat(8,1fr); border:4px solid #333; box-shadow:0 10px 20px rgba(0,0,0,.4); }
    .square { width:100%; height:100%; }
    .light { background: var(--board-light); }
    .dark  { background: var(--board-dark); position:relative; }
    .piece { width:100%; height:100%; display:grid; place-items:center; font-size:1.6em; user-select:none; }
    .captured { margin-top:8px; padding:8px; background:#111; border-radius:6px; min-height:60px; }
    .panel { background: var(--panel); padding:12px; border-radius:8px; }
    .move-list { list-style:none; padding:0; margin:0; max-height:260px; overflow:auto; }
    .move-item { padding:6px 0; border-bottom:1px solid #333; }
    .timer { font-family: monospace; padding:6px 10px; display:inline-block; border-radius:6px; background:#222; min-width:60px; text-align:center; }
    .timer.active { background:#333; }
    .tick { animation: pulse 0.5s steps(1) 1; }
    @keyframes pulse { 0% { opacity:.0; } 50% { opacity:1; } 100% { opacity:0; } }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="brand">
        <img src="data:image/svg+xml;utf8,
          <svg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'>
            <circle cx='20' cy='20' r='18' fill='%232F9F9A' opacity='0.2'/>
            <text x='50%' y='54%' text-anchor='middle' font-family='Arial' font-size='14' fill='white'>â™ž</text>
          </svg>" alt="Knight" />
        <strong>The Chess Arena Pi</strong>
      </div>
      <div>
        <button class="btn" id="newGameBtn">New Game</button>
      </div>
    </div>

    <div class="grid">
      <div class="board-wrap panel" style="padding:8px;">
        <div id="board" class="board"></div>
        <div id="captured" class="captured" aria-label="Captured pieces"></div>
      </div>

      <aside class="panel" style="padding:12px;">
        <div class="section" style="margin-bottom:10px;">
          <div class="title" style="margin-bottom:6px;">Move History</div>
          <ol id="moveList" class="move-list"></ol>
        </div>
        <div class="section" style="margin-bottom:10px;">
          <div class="title" style="margin-bottom:6px;">Timers</div>
          <div id="timers" aria-label="Timers">
            <div>White:
              <span id="whiteTimer" class="timer" data-color="white">30</span>
            </div>
            <div style="margin-top:6px;">Black:
              <span id="blackTimer" class="timer" data-color="black">30</span>
            </div>
          </div>
        </div>
        <div class="section" style="margin-bottom:0;">
          <div class="title" style="margin-bottom:6px;">Controls</div>
          <button class="btn" id="undoBtn">Undo</button>
          <button class="btn" id="muteBtn" style="margin-left:6px;">Mute</button>
        </div>
      </aside>
    </div>
  </div>

  <script>
    // Inlined JS (stand-alone)
    // Simple stand-alone chess engine (tiny, not full FIDE)
    const PIECES = { w: {K:'K',Q:'Q',R:'R',B:'B',N:'N',P:'P'}, b: {K:'k',Q:'q',R:'r',B:'b',N:'n',P:'p'} };
    // minimal starting position
    const START = [
      ['bR','bN','bB','bQ','bK','bB','bN','bR'],
      ['bP','bP','bP','bP','bP','bP','bP','bP'],
      [null,null,null,null,null,null,null,null],
      [null,null,null,null,null,null,null,null],
      [null,null,null,null,null,null,null,null],
      [null,null,null,null,null,null,null,null],
      ['wP','wP','wP','wP','wP','wP','wP','wP'],
      ['wR','wN','wB','wQ','wK','wB','wN','wR'],
    ];

    let board = [];
    let turn = 'w';
    let selected = null;
    let moves = [];
    let whiteTime = 30, blackTime = 30;
    let timerInterval = null;

    const boardEl = document.getElementById('board');
    const moveListEl = document.getElementById('moveList');
    const whiteTimerEl = document.getElementById('whiteTimer');
    const blackTimerEl = document.getElementById('blackTimer');
    const whiteCap = document.getElementById('captured');

    function cloneBoard(b){
      return b.map(r => r.slice());
    }

    function resetBoard(){
      board = START.map(r => r.slice());
      turn = 'w';
      selected = null;
      moves = [];
      whiteTime = 30; blackTime = 30;
      renderBoard();
      renderMoves();
    }

    function renderBoard(){
      boardEl.innerHTML = '';
      for(let r=0; r<8; r++){
        for(let c=0; c<8; c++){
          const isLight = (r + c) % 2 === 0;
          const sq = document.createElement('div');
          sq.className = 'square ' + (isLight ? 'light':'dark');
          sq.style.width = sq.style.height = '12.5%';
          sq.dataset = JSON.stringify({r,c});
          sq.addEventListener('click', ()=>{ onSquareClick(r,c); });
          const piece = board[r][c];
          if(piece){
            const p = document.createElement('div');
            p.className = 'piece';
            const color = piece.startsWith('w') ? '#F2F2E6' : '#2B2B2B';
            const type = piece[1];
            const glyph = (color === '#F2F2E6') ? piece[1].toUpperCase() : piece[1].toUpperCase();
            p.textContent = glyph;
            p.style.color = color;
            sq.appendChild(p);
          }
          boardEl.appendChild(sq);
        }
      }
    }

    function onSquareClick(r,c){
      const cell = board[r][c];
      if(cell && cell[0] === turn){
        selected = {r,c};
        // highlight could be added
        return;
      }
      if(selected){
        // move
        const from = selected;
        board[c?0:0] // dummy to avoid lint
        const piece = board[selected.r][selected.c];
        board[selected.r][selected.c] = null;
        board[r][c] = piece;
        moves.push(`${coordsToAlgebra(selected.r,selected.c)}-${coordsToAlgebra(r,c)}`);
        selected = null;
        turn = (turn === 'w') ? 'b' : 'w';
        renderBoard();
        renderMoves();
      }
    }

    function coordsToAlgebra(rr,cc){
      const files = 'abcdefgh';
      return files[cc] + (8 - rr);
    }

    function renderMoves(){
      moveListEl.innerHTML = '';
      moves.forEach((mv, i)=> {
        const li = document.createElement('li');
        li.className = 'move-item';
        li.textContent = (i+1) + '. ' + mv;
        moveListEl.appendChild(li);
      });
    }

    function startTimer(){
      if(timerInterval) clearInterval(timerInterval);
      timerInterval = setInterval(()=>{
        // naive per-move timer: decrement both locally
        // For demo, just decrement white then black alternatingly
        // (This is a simple visual; not a strict per-move timer)
        if(turn==='w'){
          whiteTime = Math.max(0, whiteTime - 1);
          whiteTimerEl.textContent = whiteTime;
          if(whiteTime <= 10) whiteTimerEl.classList.add('tick');
        } else {
          blackTime = Math.max(0, blackTime - 1);
          blackTimerEl.textContent = blackTime;
          if(blackTime <= 10) blackTimerEl.classList.add('tick');
        }
        // stop not implemented for brevity
      }, 1000);
    }

    function stopTimer(){ if(timerInterval) clearInterval(timerInterval); timerInterval = null; }

    // Init
    resetBoard();
    startTimer();

    // Bind New Game
    document.getElementById('newGameBtn').onclick = ()=> resetBoard();
    document.getElementById('muteBtn').onclick = ()=> alert('Mute (standalone)');

  </script>
</body>
</html>
