<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chess Arena</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chessboard.js/1.0.0/chessboard-1.0.0.min.css"/>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #f3e5ab;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    section {
      display: none;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      width: 100%;
    }
    section.active { display: flex; }
    h1,h2 { margin: 10px 0; }
    .btn {
      background: #ffca28;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      margin: 6px;
      cursor: pointer;
      font-size: 16px;
    }
    #board {
      width: 90vw;
      max-width: 480px;
    }
    #status {
      margin-top: 10px;
      padding: 10px;
      background: #fff3e0;
      border-radius: 6px;
      width: 90vw;
      max-width: 480px;
      text-align: center;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 90%;
      max-width: 480px;
      background: #3e2723;
      color: #fff;
      padding: 8px;
      border-radius: 6px;
    }
    .timer { font-weight: bold; }
  </style>
</head>
<body>

  <!-- Intro -->
  <section id="intro" class="active">
    <h1>♟️ Chess Arena ♟️</h1>
    <p>[Animated 3D Logo + Sound placeholder]</p>
    <button class="btn" onclick="gotoFrame('login')">Continue</button>
  </section>

  <!-- Login -->
  <section id="login">
    <h2>Login</h2>
    <input type="text" placeholder="Player ID">
    <button class="btn" onclick="gotoFrame('menu')">Login</button>
  </section>

  <!-- Menu -->
  <section id="menu">
    <h2>Menu</h2>
    <button class="btn" onclick="gotoFrame('puzzle')">PUZZLE</button>
    <button class="btn" onclick="startGame('classic')">CLASSIC</button>
    <button class="btn" disabled style="opacity:0.5;">QUICK (coming)</button>
    <button class="btn">Leaderboard</button>
  </section>

  <!-- Puzzle Placeholder -->
  <section id="puzzle">
    <h2>Puzzle Mode</h2>
    <p>[Future content]</p>
    <button class="btn" onclick="gotoFrame('menu')">Back</button>
  </section>

  <!-- Main Game -->
  <section id="game">
    <header>
      <span id="opponent">Opponent</span>
      <span class="timer" id="oppoTimer">15:00</span>
    </header>
    <div id="board"></div>
    <header>
      <span id="player">You</span>
      <span class="timer" id="playerTimer">15:00</span>
    </header>
    <div id="status">
      <p id="gameStatus">White to move</p>
      <p id="moveHistory">Moves: —</p>
    </div>
  </section>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chessboard.js/1.0.0/chessboard-1.0.0.min.js"></script>
  <script>
    // Navigation between frames
    function gotoFrame(id) {
      document.querySelectorAll("section").forEach(s=>s.classList.remove("active"));
      document.getElementById(id).classList.add("active");
    }

    // Start a game
    var game, board, timers, activeTimer;
    function startGame(mode) {
      gotoFrame('game');
      game = new Chess();
      board = Chessboard('board', {
        draggable: true,
        position: 'start',
        onDrop: onDrop
      });
      if(mode==='classic'){ initTimers(15*60); }
    }

    function onDrop(source, target) {
      var move = game.move({ from: source, to: target, promotion:'q' });
      if(move === null) return 'snapback';
      switchTimers();
      updateStatus();
    }

    function updateStatus() {
      var status='';
      if(game.in_checkmate()){ status='Checkmate! '+(game.turn()==='w'?'Black':'White')+' wins'; }
      else if(game.in_draw()){ status='Draw!'; }
      else{ status=(game.turn()==='w'?'White':'Black')+' to move'; }
      document.getElementById('gameStatus').innerText=status;
      document.getElementById('moveHistory').innerText="Moves: "+game.history().join(' ');
    }

    // Timers
    function initTimers(seconds){
      clearInterval(timers);
      var player=seconds, oppo=seconds;
      document.getElementById('playerTimer').innerText=format(player);
      document.getElementById('oppoTimer').innerText=format(oppo);
      activeTimer='player';
      timers=setInterval(()=>{
        if(activeTimer==='player'){ player--; update('playerTimer',player); if(player<=0) endGame('Opponent'); }
        else{ oppo--; update('oppoTimer',oppo); if(oppo<=0) endGame('Player'); }
      },1000);
    }
    function switchTimers(){ activeTimer=(activeTimer==='player'?'oppo':'player'); }
    function update(id,sec){ document.getElementById(id).innerText=format(sec); }
    function format(s){ const m=Math.floor(s/60),ss=s%60; return `${m}:${ss<10?'0':''}${ss}`; }
    function endGame(winner){ alert(winner+" wins by time!"); clearInterval(timers); }
  </script>
</body>
</html>
